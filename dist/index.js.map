{"version":3,"file":"index.js","sources":["../src/useCustomScroller.js","../node_modules/style-inject/dist/style-inject.es.js","../src/index.js"],"sourcesContent":["import { useLayoutEffect, useRef, useState, useCallback } from 'react';\n\n/**\n * We use a negative right on the content to hide original OS scrollbars\n */\nconst OS_SCROLLBAR_WIDTH = (() => {\n  const outer = document.createElement('div');\n  const inner = document.createElement('div');\n  outer.style.overflow = 'scroll';\n  outer.style.width = '100%';\n  inner.style.width = '100%';\n\n  document.body.appendChild(outer);\n  outer.appendChild(inner);\n  const scrollbarWidth = outer.offsetWidth - inner.offsetWidth;\n  outer.removeChild(inner);\n  document.body.removeChild(outer);\n\n  return scrollbarWidth;\n})();\n\n/**\n * We need this for OSs that automatically hide the scrollbar (so the offset\n * doesn't change in such case). Eg: macOS with \"Automatically based on mouse\".\n */\nconst SCROLLBAR_WIDTH = OS_SCROLLBAR_WIDTH || 20;\n\n/**\n * Ported from Vitor's SimpleScrollbar library (vanilla JS):\n * https://github.com/buzinas/simple-scrollbar\n * @param {React.ReactNode} content Used as a dependency to re-run the effect\n * @param {React.MutableRefObject} [customRef]\n * @param {Object} [options={}]\n * @param {boolean} [options.disabled]\n */\nexport default function useCustomScroller(\n  content,\n  customRef,\n  { disabled } = {},\n) {\n  const [scrollRatio, setScrollRatio] = useState(1);\n  const [isDraggingTrack, setIsDraggingTrack] = useState(false);\n\n  const ref = useRef();\n  const scrollerRef = customRef || ref;\n  const trackRef = useRef();\n  const trackAnimationRef = useRef();\n  const memoizedProps = useRef({});\n\n  useLayoutEffect(() => {\n    const el = scrollerRef.current;\n    let scrollbarAnimation;\n\n    const updateScrollbar = () => {\n      cancelAnimationFrame(scrollbarAnimation);\n      scrollbarAnimation = requestAnimationFrame(() => {\n        const { clientHeight, scrollHeight } = el;\n        setScrollRatio(clientHeight / scrollHeight);\n        memoizedProps.current = {\n          clientHeight,\n          scrollHeight,\n          trackHeight: trackRef.current.clientHeight,\n        };\n      });\n    };\n\n    window.addEventListener('resize', updateScrollbar);\n    updateScrollbar();\n\n    return () => {\n      cancelAnimationFrame(scrollbarAnimation);\n      window.removeEventListener('resize', updateScrollbar);\n    };\n  }, [scrollerRef, content]);\n\n  useLayoutEffect(() => {\n    if (!disabled) return;\n    const el = scrollerRef.current;\n\n    const onWheel = e => e.preventDefault();\n    el.addEventListener('wheel', onWheel, { passive: false });\n\n    return () => {\n      el.removeEventListener('wheel', onWheel);\n    };\n  }, [scrollerRef, disabled]);\n\n  const onScroll = useCallback(() => {\n    if (scrollRatio === 1) return;\n    const el = scrollerRef.current;\n    const track = trackRef.current;\n\n    cancelAnimationFrame(trackAnimationRef.current);\n\n    trackAnimationRef.current = requestAnimationFrame(() => {\n      const { clientHeight, scrollHeight, trackHeight } = memoizedProps.current;\n      const ratio = el.scrollTop / (scrollHeight - clientHeight);\n      const y = ratio * (clientHeight - trackHeight);\n      track.style.transform = `translateY(${y}px)`;\n    });\n  }, [scrollerRef, scrollRatio]);\n\n  const moveTrack = useCallback(\n    e => {\n      const el = scrollerRef.current;\n      let moveAnimation;\n      let lastPageY = e.pageY;\n      let lastScrollTop = el.scrollTop;\n\n      setIsDraggingTrack(true);\n\n      const drag = ({ pageY }) => {\n        cancelAnimationFrame(moveAnimation);\n        moveAnimation = requestAnimationFrame(() => {\n          const delta = pageY - lastPageY;\n          lastScrollTop += delta / scrollRatio;\n          lastPageY = pageY;\n          el.scrollTop = lastScrollTop;\n        });\n      };\n\n      const stop = () => {\n        setIsDraggingTrack(false);\n        window.removeEventListener('mousemove', drag);\n      };\n\n      window.addEventListener('mousemove', drag);\n      window.addEventListener('mouseup', stop, { once: true });\n    },\n    [scrollerRef, scrollRatio],\n  );\n\n  const wrapperProps = {\n    style: {\n      marginLeft: `-${SCROLLBAR_WIDTH}px`,\n    },\n  };\n\n  const scrollerProps = {\n    ref: scrollerRef,\n    onScroll: disabled ? undefined : onScroll,\n    style: {\n      right: `-${SCROLLBAR_WIDTH}px`,\n      padding: `0 ${SCROLLBAR_WIDTH}px 0 0`,\n      width: `calc(100% + ${OS_SCROLLBAR_WIDTH}px)`,\n    },\n  };\n\n  const trackProps = {\n    ref: trackRef,\n    onMouseDown: disabled ? undefined : moveTrack,\n    style: {\n      right: isDraggingTrack ? 1 : undefined,\n      width: isDraggingTrack ? 10 : undefined,\n      height: `${scrollRatio * 100}%`,\n      opacity: isDraggingTrack ? 1 : undefined,\n      display: disabled || scrollRatio === 1 ? 'none' : undefined,\n    },\n  };\n\n  return [wrapperProps, scrollerProps, trackProps];\n}\n","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import React, { forwardRef } from 'react';\nimport PropTypes from 'prop-types';\n\nimport useCustomScroller from './useCustomScroller';\n\nimport styles from './index.module.css';\n\nconst cx = (...args) => args.filter(Boolean).join(' ');\n\nconst CustomScroller = forwardRef(\n  ({ scrollDisabled, className, innerClassName, children, ...props }, ref) => {\n    const [wrapperProps, scrollerProps, trackProps] = useCustomScroller(\n      children,\n      ref,\n      { disabled: scrollDisabled },\n    );\n\n    return (\n      <div className={cx(className, styles.main)} {...props}>\n        <div className={styles.wrapper} {...wrapperProps}>\n          <div className={cx(innerClassName, styles.inner)} {...scrollerProps}>\n            {children}\n          </div>\n        </div>\n        <div className={\"CustomScrollerTrack\"} {...trackProps} />\n      </div>\n    );\n  },\n);\n\nCustomScroller.propTypes = {\n  scrollDisabled: PropTypes.bool,\n  innerClassName: PropTypes.string,\n  className: PropTypes.string,\n  children: PropTypes.node.isRequired,\n};\n\nCustomScroller.displayName = 'CustomScroller';\n\nexport default CustomScroller;\n"],"names":["OS_SCROLLBAR_WIDTH","outer","document","createElement","inner","style","overflow","width","body","appendChild","scrollbarWidth","offsetWidth","removeChild","SCROLLBAR_WIDTH","useCustomScroller","content","customRef","disabled","useState","scrollRatio","setScrollRatio","isDraggingTrack","setIsDraggingTrack","ref","useRef","scrollerRef","trackRef","trackAnimationRef","memoizedProps","useLayoutEffect","el","current","scrollbarAnimation","updateScrollbar","cancelAnimationFrame","requestAnimationFrame","clientHeight","scrollHeight","trackHeight","window","addEventListener","removeEventListener","onWheel","e","preventDefault","passive","onScroll","useCallback","track","ratio","scrollTop","y","transform","moveTrack","moveAnimation","lastPageY","pageY","lastScrollTop","drag","delta","stop","once","wrapperProps","marginLeft","scrollerProps","undefined","right","padding","trackProps","onMouseDown","height","opacity","display","cx","args","filter","Boolean","join","CustomScroller","forwardRef","scrollDisabled","className","innerClassName","children","props","React","styles","main","wrapper","propTypes","PropTypes","bool","string","node","isRequired","displayName"],"mappings":"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"}